<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>题解 P3312 【[SDOI2014]数表】 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一道数论+数据结构的DuLiu题我们要求的就是 Ans&#x3D;\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^m\sum_{d|i\wedge d|j}d[\sum_{d|i\wedge d|j}d\leq a]考虑到$d|i \wedge d|j$等价于$ d|gcd(i,j)$ Ans&#x3D;\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^m\sum_{d|gcd(i,j)}d[\sum_{d|gcd(i,j">
<meta property="og:type" content="article">
<meta property="og:title" content="题解 P3312 【[SDOI2014]数表】">
<meta property="og:url" content="http://yoursite.com/2020/06/05/%E9%A2%98%E8%A7%A3-P3312-%E3%80%90-SDOI2014-%E6%95%B0%E8%A1%A8%E3%80%91/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="一道数论+数据结构的DuLiu题我们要求的就是 Ans&#x3D;\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^m\sum_{d|i\wedge d|j}d[\sum_{d|i\wedge d|j}d\leq a]考虑到$d|i \wedge d|j$等价于$ d|gcd(i,j)$ Ans&#x3D;\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^m\sum_{d|gcd(i,j)}d[\sum_{d|gcd(i,j">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-06-05T11:01:00.000Z">
<meta property="article:modified_time" content="2020-06-05T11:03:52.846Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="莫比乌斯反演">
<meta property="article:tag" content="树状数组">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-题解-P3312-【-SDOI2014-数表】" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/05/%E9%A2%98%E8%A7%A3-P3312-%E3%80%90-SDOI2014-%E6%95%B0%E8%A1%A8%E3%80%91/" class="article-date">
  <time datetime="2020-06-05T11:01:00.000Z" itemprop="datePublished">2020-06-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      题解 P3312 【[SDOI2014]数表】
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="一道数论-数据结构的DuLiu题"><a href="#一道数论-数据结构的DuLiu题" class="headerlink" title="一道数论+数据结构的DuLiu题"></a>一道数论+数据结构的DuLiu题</h1><p>我们要求的就是</p>
<script type="math/tex; mode=display">Ans=\sum_{i=1}^n\sum_{j=1}^m\sum_{d|i\wedge d|j}d[\sum_{d|i\wedge d|j}d\leq a]</script><p>考虑到$d|i \wedge d|j$等价于$ d|gcd(i,j)$</p>
<script type="math/tex; mode=display">Ans=\sum_{i=1}^n\sum_{j=1}^m\sum_{d|gcd(i,j)}d[\sum_{d|gcd(i,j)}d\leq a]</script><p>令$f(x)=\sum_{i|x}i$,即因子和,<br>把$f(x)$带入</p>
<script type="math/tex; mode=display">Ans=\sum_{i=1}^n\sum_{j=1}^m f(gcd(i,j))[f(gcd(i,j))\leq a]</script><script type="math/tex; mode=display">枚举因数</script><script type="math/tex; mode=display">Ans=\sum_{d=1}^n \sum_{i=1}^{\lfloor\frac n d\rfloor}\sum_{j=1}^{\lfloor\frac m d\rfloor} f(d)[f(d)\leq a][gcd(i,j)==1]</script><p>把$f(d)[f(d)\leq a]$提前并使用莫比乌斯反演</p>
<script type="math/tex; mode=display">Ans=\sum_{d=1}^n f(d)[f(d)\leq a]\sum_{i=1}^{\lfloor\frac n d\rfloor}\sum_{j=1}^{\lfloor\frac m d\rfloor} \sum_{x|gcd(i,j)} \mu(x)</script><script type="math/tex; mode=display">把枚举x提前</script><script type="math/tex; mode=display">Ans=\sum_{d=1}^n f(d)[f(d)\leq a]\sum_{x=1}^{\lfloor \frac n d \rfloor} \mu(x)\sum_{i=1}^{\lfloor\frac n d\rfloor}[x|i]\sum_{j=1}^{\lfloor\frac m d\rfloor}[x|j]</script><script type="math/tex; mode=display">稍稍化简</script><script type="math/tex; mode=display">Ans=\sum_{d=1}^n f(d)[f(d)\leq a]\sum_{x=1}^{\lfloor \frac n d \rfloor} \mu(x)\lfloor \frac n {dx}\rfloor \lfloor \frac m {dx}\rfloor</script><script type="math/tex; mode=display">令dx=T</script><script type="math/tex; mode=display">Ans=\sum_{T=1}^n\sum_{d|T} f(d)[f(d)\leq a]\mu(\frac T d)\lfloor \frac n T\rfloor \lfloor \frac m T\rfloor</script><p>我们发现，只有$f(d)\leq a$的$d$,才能对$ans$有贡献<br>辣么如果从$a\to a’$,$A=\{x,a&lt;f(x)\leq a’\}$,会对$A$中所有元素及其倍数造成贡献<br>因此我们可以用某种数据结构来维护$\sum_{d|T} f(d)[f(d)\leq a]\mu(\frac T d)$,很明显BIT是一种很好的选择<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">const int maxn&#x3D;1e5+10;</span><br><span class="line">template &lt;class T&gt;inline void read(T &amp;x)&#123;</span><br><span class="line">	x&#x3D;0;char c&#x3D;getchar();</span><br><span class="line">	for(;!isdigit(c);c&#x3D;getchar());</span><br><span class="line">	for(;isdigit(c);c&#x3D;getchar())x&#x3D;x*10+c-&#39;0&#39;;</span><br><span class="line">	return;</span><br><span class="line">&#125;</span><br><span class="line">template &lt;class T&gt;void write(T x)&#123;</span><br><span class="line">	if(x&lt;0)putchar(&#39;-&#39;),x&#x3D;-x;</span><br><span class="line">	if(x&gt;&#x3D;10)write(x&#x2F;10);</span><br><span class="line">	putchar(x%10+&#39;0&#39;);</span><br><span class="line">&#125;</span><br><span class="line">bool isprime[maxn];</span><br><span class="line">int miu[maxn],prime[maxn],tot;</span><br><span class="line">int sigma[maxn];&#x2F;&#x2F;因数和 </span><br><span class="line">void init()&#123;</span><br><span class="line">	memset(isprime,0xff,sizeof isprime);</span><br><span class="line">	tot&#x3D;0;miu[1]&#x3D;1;</span><br><span class="line">	for(int i&#x3D;2;i&lt;maxn;i++)&#123;</span><br><span class="line">		if(isprime[i])</span><br><span class="line">			prime[++tot]&#x3D;i,miu[i]&#x3D;-1;</span><br><span class="line">		for(int j&#x3D;1;j&lt;&#x3D;tot&amp;&amp;i*prime[j]&lt;maxn;j++)&#123;</span><br><span class="line">			isprime[i*prime[j]]&#x3D;false;</span><br><span class="line">			if(i%prime[j])</span><br><span class="line">				miu[i*prime[j]]&#x3D;-miu[i];</span><br><span class="line">			else&#123;</span><br><span class="line">				miu[i*prime[j]]&#x3D;0;</span><br><span class="line">				break;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	for(int i&#x3D;1;i&lt;maxn;i++)</span><br><span class="line">		for(int j&#x3D;1;i*j&lt;maxn;j++)</span><br><span class="line">			sigma[i*j]+&#x3D;i;</span><br><span class="line">&#125;</span><br><span class="line">struct BIT&#123;</span><br><span class="line">	#define lowbit(x) x&amp;(-x)</span><br><span class="line">	signed tree[maxn];</span><br><span class="line">	void add(int x,int val)&#123;</span><br><span class="line">		&#x2F;&#x2F;printf(&quot;A %d %d\n&quot;,x,val);</span><br><span class="line">		while(x&lt;maxn)&#123;</span><br><span class="line">			tree[x]+&#x3D;val;</span><br><span class="line">			x+&#x3D;lowbit(x);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	signed query(int x)&#123;</span><br><span class="line">		&#x2F;&#x2F;printf(&quot;Q %d\n&quot;,x);</span><br><span class="line">		signed ret&#x3D;0;</span><br><span class="line">		while(x)&#123;</span><br><span class="line">			ret+&#x3D;tree[x];</span><br><span class="line">			x-&#x3D;lowbit(x);</span><br><span class="line">		&#125;</span><br><span class="line">		return ret;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;A;</span><br><span class="line">struct Num&#123;</span><br><span class="line">	int id,val;</span><br><span class="line">	bool operator&lt;(const Num b)const&#123;return val&lt;b.val;&#125;</span><br><span class="line">&#125;S[maxn];</span><br><span class="line">struct Que&#123;</span><br><span class="line">	int id,n,m,a;</span><br><span class="line">	bool operator&lt;(const Que b)const&#123;return a&lt;b.a;&#125;</span><br><span class="line">&#125;Q[maxn];</span><br><span class="line">signed ans[maxn];</span><br><span class="line">int t;</span><br><span class="line">void solve()&#123;</span><br><span class="line">	int now&#x3D;0;&#x2F;&#x2F;已经用过的S </span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;t;i++)&#123;</span><br><span class="line">		while(S[now+1].val&lt;&#x3D;Q[i].a&amp;&amp;now+1&lt;maxn)&#123;</span><br><span class="line">			now++;</span><br><span class="line">			for(int j&#x3D;1;j*S[now].id&lt;maxn;j++)</span><br><span class="line">				A.add(j*S[now].id,miu[j]*S[now].val);</span><br><span class="line">		&#125;</span><br><span class="line">		ans[Q[i].id]&#x3D;0;</span><br><span class="line">		int n&#x3D;max(Q[i].m,Q[i].n),m&#x3D;min(Q[i].m,Q[i].n);</span><br><span class="line">		for(int l&#x3D;1,r;l&lt;&#x3D;m;l&#x3D;r+1)&#123;</span><br><span class="line">			r&#x3D;min(m&#x2F;(m&#x2F;l),n&#x2F;(n&#x2F;l));</span><br><span class="line">			ans[Q[i].id]+&#x3D;(m&#x2F;l)*(n&#x2F;l)*(A.query(r)-A.query(l-1));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line">signed main()&#123;</span><br><span class="line">	init();</span><br><span class="line">	read(t);</span><br><span class="line">	for(int i&#x3D;1;i&lt;maxn;i++)</span><br><span class="line">		S[i]&#x3D;&#123;i,sigma[i]&#125;;</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;t;i++)&#123;</span><br><span class="line">		Q[i].id&#x3D;i;</span><br><span class="line">		read(Q[i].n);read(Q[i].m);read(Q[i].a);</span><br><span class="line">	&#125;</span><br><span class="line">	sort(S+1,S+maxn);sort(Q+1,Q+t+1);</span><br><span class="line">	solve();</span><br><span class="line">	for(int i&#x3D;1;i&lt;&#x3D;t;i++)</span><br><span class="line">		write((1ll*ans[i]+(1ll&lt;&lt;31))%(1ll&lt;&lt;31)),putchar(&#39;\n&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/05/%E9%A2%98%E8%A7%A3-P3312-%E3%80%90-SDOI2014-%E6%95%B0%E8%A1%A8%E3%80%91/" data-id="ckb23pd3l0000jajx2wbadrd4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" rel="tag">树状数组</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2020/06/05/%E9%A2%98%E8%A7%A3-P3172-%E3%80%90-CQOI2015-%E9%80%89%E6%95%B0%E3%80%91/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">题解 P3172 【[CQOI2015]选数】</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/dp/" rel="tag">dp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" rel="tag">树状数组</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" rel="tag">莫比乌斯反演</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/dp/" style="font-size: 10px;">dp</a> <a href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" style="font-size: 20px;">树状数组</a> <a href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" style="font-size: 20px;">莫比乌斯反演</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/06/05/%E9%A2%98%E8%A7%A3-P3312-%E3%80%90-SDOI2014-%E6%95%B0%E8%A1%A8%E3%80%91/">题解 P3312 【[SDOI2014]数表】</a>
          </li>
        
          <li>
            <a href="/2020/06/05/%E9%A2%98%E8%A7%A3-P3172-%E3%80%90-CQOI2015-%E9%80%89%E6%95%B0%E3%80%91/">题解 P3172 【[CQOI2015]选数】</a>
          </li>
        
          <li>
            <a href="/2020/06/04/%E9%A2%98%E8%A7%A3-CF698C-%E3%80%90LRU%E3%80%91/">题解 CF698C 【LRU】</a>
          </li>
        
          <li>
            <a href="/2020/06/04/%E9%A2%98%E8%A7%A3-CF650D-%E3%80%90Zip-line%E3%80%91/">题解 CF650D 【Zip-line】</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>